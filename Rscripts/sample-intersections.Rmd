```{r}
source("Rscripts/utils.R")
library(valr)
setwd("~/projects/phased-fdr-and-peaks/")
getwd()
```

```{r}
# run scripts/fire-correlations.sh
comparisons=my_read_bed("Tables/fire-correlations.tbl.gz") %>%
    mutate(bin = round(PS00388)) 

comparisons  
```

```{r}
z=comparisons %>% 
    #group_by(bin) %>% mutate(row=seq(n())) %>% filter(row<10000) %>%
    pivot_longer(
        c("GM12878", "PS00356")
    ) %>%
    arrange(name)%>%
    mutate(name=factor(name, levels=rev(unique(name)))) %>%
    ggplot(aes(x=PS00388, y=value)) +
    geom_hex(bins=50) + scale_fill_distiller("", palette = "Spectral", trans="log10") +
    stat_cor(size=2.5)+
    scale_x_continuous("FIRE score of PS00388") + 
    scale_y_continuous("FIRE score") + 
    facet_row(~name,    strip.position = "left") + 
    my_grid() 
my_ggsave("Figures/FIRE-peak-corelation.pdf", height=3, width=7)
```

```{r}
z=comparisons %>% 
    ggplot(aes(x=DNase, y=GM12878)) +
    geom_hex(bins=50) + scale_fill_distiller("", palette = "Spectral", trans="log10") +
    stat_cor(size=2.5)+
    #scale_x_continuous("FIRE score of PS00388") + 
    scale_y_continuous("DNase signal", trans="log10") + 
    my_grid() 
my_ggsave("Figures/FIRE-peak-DNase-corelation.pdf", height=3, width=4)
```